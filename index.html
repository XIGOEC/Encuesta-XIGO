<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XIGO - Encuesta Completa (23 Preguntas)</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & Babel -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        xigo: '#2D5A27',
                        'xigo-light': '#f0fdf4',
                    }
                }
            }
        }
    </script>
    <style>
        .fade-in { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        body { background-color: #f9fafb; margin: 0; padding: 0; font-family: sans-serif; }
        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #2D5A27; border-radius: 10px; }
        
        .header-bg {
            background-color: #2D5A27;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        .header-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .admin-row:hover { background-color: #f0fdf4; cursor: pointer; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const ADMIN_PASSWORD = "XIGO2026"; 
        const LOGO_URL = "https://i.ibb.co/SD87TqHW/Black-Modern-Minimalist-Letter-A-Logo-1-1.png"; 

        const surveyData = [
            // SECCI√ìN 0 - FILTRO (3 PREGUNTAS)
            {
                section: "Secci√≥n 0 - Filtro",
                title: "¬øEn los √∫ltimos 30 d√≠as, has comprado comida preparada o empacada para consumir fuera de casa o en tu lugar de estudio/trabajo?",
                options: ["S√≠, lo he comprado", "No, pero lo considerar√≠a si fuera conveniente", "No, no me interesa"],
                type: "single",
                terminateIf: "No, no me interesa"
            },
            {
                section: "Secci√≥n 0 - Filtro",
                title: "¬øCu√°l describe mejor tu situaci√≥n actual?",
                options: ["Trabajo fuera de casa", "Trabajo desde casa / Online", "Trabajo mixto [Oficina + Casa]", "Estudiante / No trabajo"],
                type: "single"
            },
            {
                section: "Secci√≥n 0 - Filtro",
                title: "¬øCon qu√© frecuencia almuerzas fuera de casa en una semana laboral (lunes a viernes)?",
                options: ["0 veces", "1 a 2 veces", "3 a 4 veces", "5 veces (todos los d√≠as)"],
                type: "single"
            },
            // SECCI√ìN 1 - COMIDA (8 PREGUNTAS)
            {
                section: "Secci√≥n 1 - Comida",
                title: "¬øHas comprado alguna vez comida preparada para consumir despu√©s (Refrigerada o en tarrinas empacadas)?",
                options: ["S√≠, regularmente", "S√≠, algunas veces", "No, pero me llama la atenci√≥n", "No, no me interesa"],
                type: "single"
            },
            {
                section: "Secci√≥n 1 - Comida",
                title: "¬øEn qu√© situaciones elegir√≠as comida lista durante un d√≠a laboral? (Puedes elegir varias)",
                options: ["Con poco tiempo para salir a almorzar", "Reuniones o trabajo continuo", "No alcanc√© a cocinarme", "Para comer en la oficina", "Entre reuniones o traslados", "Para llevar a casa", "No lo considerar√≠a"],
                type: "multiple"
            },
            {
                section: "Secci√≥n 1 - Comida",
                title: "¬øQu√© tipo de comida te genera m√°s apetito y confianza si viene lista y empacada? (Elige hasta 3)",
                options: ["Comida tradicional ecuatoriana", "Comida casera ligera (Arroz, carnes, pollo)", "Bowls balanceados (Sushi, pasta, ensaladas)", "Ensaladas completas", "Sopas / Cremas", "Snacks salados", "No confiar√≠a en comida empacada"],
                type: "multiple",
                max: 3
            },
            {
                section: "Secci√≥n 1 - Comida",
                title: "Para tu almuerzo o cena, ¬øqu√© tama√±o de porci√≥n prefieres normalmente?",
                options: ["Ligero (para no sentirse pesado)", "Normal (me deja satisfecho)", "Grande (me gusta quedar lleno)", "Depende del d√≠a"],
                type: "single"
            },
            {
                section: "Secci√≥n 1 - Comida",
                title: "¬øQu√© esperas de un almuerzo para sentir que 'vali√≥ la pena'? (Elige hasta 3)",
                options: ["Que me llene (porci√≥n)", "Que sea saludable / balanceado", "Buena cantidad de prote√≠na", "Que sea r√°pido y pr√°ctico", "Que tenga muy buen sabor"],
                type: "multiple",
                max: 3
            },
            {
                section: "Secci√≥n 1 - Comida",
                title: "¬øQu√© factor te har√≠a dudar al comprar comida lista? (Elige hasta 3)",
                options: ["Frescura de los ingredientes", "Higiene y seguridad", "Sabor", "Precio", "Tama√±o de la porci√≥n", "Uso de conservantes", "Fecha de caducidad", "Empaque sostenible"],
                type: "multiple",
                max: 3
            },
            {
                section: "Secci√≥n 1 - Comida",
                title: "Si tuvieras acceso a comida lista, fresca y de calidad cerca de tu rutina, ¬øcon qu√© frecuencia la consumir√≠as?",
                options: ["Nunca", "1 vez por semana", "2 a 3 veces por semana", "Casi todos los d√≠as laborables"],
                type: "single"
            },
            {
                section: "Secci√≥n 1 - Comida",
                title: "¬øConsiderar√≠as pedir comida lista por delivery si fuera una opci√≥n confiable y de alta calidad?",
                options: ["S√≠, con frecuencia", "S√≠, ocasionalmente", "Tal vez", "No"],
                type: "single"
            },
            // SECCI√ìN 2 - PRECIOS Y ELASTICIDAD (5 PREGUNTAS)
            {
                section: "Secci√≥n 2 - Precios",
                title: "¬øCu√°nto sueles pagar actualmente por tu almuerzo promedio entre semana?",
                options: ["Menos de $4.99", "$5.00 a $7.99", "$8.00 a $9.99", "$10.00 a $11.99", "$12.00 o m√°s", "No suelo comprar almuerzo"],
                type: "single"
            },
            {
                section: "Secci√≥n 2 - Precios",
                title: "¬øQu√© precio te parece razonable para un almuerzo de excelente calidad, fresco y balanceado?",
                options: ["Menos de $4.99", "$5.00 a $7.99", "$8.00 a $9.99", "$10.00 a $11.99", "$12.00 o m√°s"],
                type: "single"
            },
            {
                section: "Secci√≥n 2 - Precios",
                title: "¬øA partir de qu√© precio considerar√≠as que un almuerzo listo ya es demasiado CARO?",
                options: ["Menos de $4.99", "$5.00 a $7.99", "$8.00 a $9.99", "$10.00 a $11.99", "$12.00 o m√°s"],
                type: "single"
            },
            {
                section: "Secci√≥n 2 - Precios",
                title: "¬øQu√© formato de compra de comida lista te resultar√≠a m√°s atractivo?",
                options: ["Pedido puntual del d√≠a", "Pack para 2 o 3 d√≠as", "Pack para toda la semana laboral", "No me interesa"],
                type: "single"
            },
            {
                section: "Secci√≥n 2 - Precios",
                title: "Si un almuerzo que hoy compras a $5.99 sube a $7.99 por costos de ingredientes y operaci√≥n, ¬øqu√© har√≠as?",
                options: ["Lo seguir√≠a comprando igual", "Lo comprar√≠a con menos frecuencia", "Buscar√≠a otra opci√≥n", "Dejar√≠a de comprarlo"],
                type: "single"
            },
            // SECCI√ìN 3 - RTD (4 PREGUNTAS)
            {
                section: "Secci√≥n 3 - Bebidas (RTD)",
                title: "Durante tu jornada laboral, ¬øcompras bebidas listas para tomar (agua, jugos, t√©s, caf√©)?",
                options: ["S√≠, casi todos los d√≠as", "Varias veces por semana", "Ocasionalmente", "Rara vez", "Nunca"],
                type: "single"
            },
            {
                section: "Secci√≥n 3 - Bebidas (RTD)",
                title: "¬øCu√°l de estas opciones te resultar√≠a m√°s atractiva en tu d√≠a a d√≠a? (Elige hasta 2)",
                options: ["Agua natural o saborizada (baja az√∫car)", "Jugo natural prensado / fresco", "T√© fr√≠o o infusi√≥n natural", "Caf√© latte / Matcha", "Bebida funcional (energ√≠a/prote√≠na)", "Bebida refrescante", "No suelo comprar"],
                type: "multiple",
                max: 2
            },
            {
                section: "Secci√≥n 3 - Bebidas (RTD)",
                title: "Cuando compras bebidas como caf√© o smoothies, ¬øqu√© tipo de leche prefieres? (Elige hasta 2)",
                options: ["Leche regular (entera)", "Leche deslactosada", "Leche de almendra", "Leche de avena", "Leche de soya", "No consumo bebidas con leche"],
                type: "multiple",
                max: 2
            },
            {
                section: "Secci√≥n 3 - Bebidas (RTD)",
                title: "¬øQu√© precio te parece razonable para una bebida RTD (Lista para tomar) de alta calidad?",
                options: ["Hasta $1.99", "$2.00 a $2.99", "$3.00 a $3.99", "$4.00 a $4.99", "M√°s de $5.00"],
                type: "single"
            },
            // SECCI√ìN 4 - PERFIL (3 PREGUNTAS)
            {
                section: "Secci√≥n 4 - Perfil",
                title: "¬øEn qu√© rango de edad te encuentras?",
                options: ["18-24 a√±os", "25-34 a√±os", "35-44 a√±os", "45-54 a√±os", "55 a√±os o m√°s"],
                type: "single"
            },
            {
                section: "Secci√≥n 4 - Perfil",
                title: "¬øCu√°l es tu g√©nero?",
                options: ["Femenino", "Masculino", "Otro / Prefiero no decir"],
                type: "single"
            },
            {
                section: "Secci√≥n 4 - Perfil",
                title: "¬øEn qu√© zona de Guayaquil / alrededores realizas la mayor√≠a de tus actividades?",
                options: ["Norte", "Centro", "Sur", "Samborond√≥n / V√≠a a la Costa", "Dur√°n"],
                type: "single"
            }
        ];

        function App() {
            const [step, setStep] = useState('survey');
            const [currentIdx, setCurrentIdx] = useState(0);
            const [answers, setAnswers] = useState({});
            const [selectedInStep, setSelectedInStep] = useState([]);
            const [email, setEmail] = useState("");
            const [isLoading, setIsLoading] = useState(false);
            const [adminClicks, setAdminClicks] = useState(0);
            const [database, setDatabase] = useState([]);
            const [selectedUser, setSelectedUser] = useState(null);

            const handleAdminAccess = () => {
                const clicks = adminClicks + 1;
                if (clicks >= 5) {
                    const p = prompt("Acceso Administrador XIGO:");
                    if (p === ADMIN_PASSWORD) setStep('admin');
                    setAdminClicks(0);
                } else {
                    setAdminClicks(clicks);
                }
            };

            const handleSelect = (val) => {
                const q = surveyData[currentIdx];
                if (q.type === 'single') {
                    const updatedAnswers = { ...answers, [q.title]: { value: val, section: q.section } };
                    setAnswers(updatedAnswers);
                    setSelectedInStep([val]);
                    
                    if (q.terminateIf && val === q.terminateIf) {
                        setStep('terminated');
                    } else {
                        setTimeout(() => {
                            if (currentIdx < surveyData.length - 1) {
                                setCurrentIdx(currentIdx + 1);
                                setSelectedInStep([]);
                            } else {
                                setStep('email');
                            }
                        }, 350);
                    }
                } else {
                    let updated = selectedInStep.includes(val)
                        ? selectedInStep.filter(i => i !== val)
                        : (q.max && selectedInStep.length >= q.max ? selectedInStep : [...selectedInStep, val]);
                    setSelectedInStep(updated);
                    setAnswers({ ...answers, [q.title]: { value: updated, section: q.section } });
                }
            };

            const nextStep = () => {
                if (currentIdx < surveyData.length - 1) {
                    setCurrentIdx(currentIdx + 1);
                    setSelectedInStep([]);
                } else {
                    setStep('email');
                }
            };

            const submitEmail = () => {
                if (!email.includes('@')) return alert("Por favor ingresa un email v√°lido");
                setIsLoading(true);
                const newRecord = {
                    id: Date.now(),
                    email: email,
                    date: new Date().toLocaleString(),
                    responses: { ...answers }
                };
                setTimeout(() => {
                    setDatabase(prev => [newRecord, ...prev]);
                    setIsLoading(false);
                    setStep('success');
                }, 1500);
            };

            if (step === 'admin') {
                const groupedResponses = selectedUser ? Object.entries(selectedUser.responses).reduce((acc, [q, data]) => {
                    const section = data.section || "General";
                    if (!acc[section]) acc[section] = [];
                    acc[section].push({ q, val: data.value });
                    return acc;
                }, {}) : {};

                return (
                    <div className="p-4 sm:p-8 bg-gray-50 min-h-screen font-sans overflow-y-auto">
                        <div className="max-w-6xl mx-auto">
                            <div className="flex justify-between items-center mb-6 bg-white p-6 rounded-3xl shadow-sm border border-gray-100">
                                <div className="flex items-center gap-4">
                                    <div className="bg-xigo p-3 rounded-2xl text-white font-black">X</div>
                                    <div>
                                        <h1 className="text-xl font-black text-gray-800 uppercase tracking-tighter">XIGO Insight Panel</h1>
                                        <p className="text-[10px] text-gray-400 font-bold uppercase tracking-widest">Base de Datos de Mercado</p>
                                    </div>
                                </div>
                                <button onClick={() => { setStep('survey'); setSelectedUser(null); }} className="bg-gray-100 hover:bg-gray-200 text-gray-600 px-6 py-2 rounded-xl font-bold transition-all text-sm">Salir</button>
                            </div>

                            <div className="grid grid-cols-1 lg:grid-cols-12 gap-6">
                                <div className="lg:col-span-4 space-y-3">
                                    <h3 className="text-xs font-black text-gray-400 uppercase ml-2 tracking-widest mb-4">Usuarios ({database.length})</h3>
                                    <div className="space-y-2 max-h-[600px] overflow-y-auto custom-scrollbar pr-2">
                                        {database.length === 0 ? (
                                            <p className="text-xs text-gray-300 italic p-4">Esperando registros...</p>
                                        ) : (
                                            database.map(user => (
                                                <div key={user.id} onClick={() => setSelectedUser(user)} className={`admin-row p-4 rounded-2xl border transition-all flex items-center justify-between ${selectedUser?.id === user.id ? 'border-xigo bg-xigo-light shadow-sm' : 'border-white bg-white'}`}>
                                                    <div className="flex items-center gap-3 overflow-hidden">
                                                        <div className={`w-8 h-8 rounded-full flex-shrink-0 flex items-center justify-center font-black text-xs ${selectedUser?.id === user.id ? 'bg-xigo text-white' : 'bg-gray-100 text-gray-400'}`}>
                                                            {user.email[0].toUpperCase()}
                                                        </div>
                                                        <div className="overflow-hidden">
                                                            <p className="text-xs font-bold text-gray-700 truncate">{user.email}</p>
                                                            <p className="text-[9px] text-gray-400 uppercase font-black">{user.date}</p>
                                                        </div>
                                                    </div>
                                                </div>
                                            ))
                                        )}
                                    </div>
                                </div>
                                <div className="lg:col-span-8">
                                    {!selectedUser ? (
                                        <div className="bg-white h-[600px] rounded-[2.5rem] flex flex-col items-center justify-center text-center border-2 border-dashed border-gray-200 p-10">
                                            <div className="text-4xl mb-4">üìä</div>
                                            <h3 className="text-gray-400 font-black uppercase tracking-widest text-sm">Selecciona un usuario</h3>
                                            <p className="text-gray-300 text-xs mt-2 italic font-medium">Visualiza las respuestas de las 23 preguntas del PDF.</p>
                                        </div>
                                    ) : (
                                        <div className="bg-white rounded-[2.5rem] shadow-sm border border-gray-100 p-8 fade-in h-fit min-h-[600px]">
                                            <div className="flex justify-between items-start mb-8 border-b border-gray-50 pb-6">
                                                <div>
                                                    <span className="bg-xigo/10 text-xigo text-[10px] font-black px-3 py-1 rounded-full uppercase mb-2 inline-block">Informe Detallado</span>
                                                    <h2 className="text-2xl font-black text-gray-800 tracking-tighter">{selectedUser.email}</h2>
                                                </div>
                                            </div>
                                            <div className="space-y-6 overflow-y-auto max-h-[500px] custom-scrollbar pr-2">
                                                {Object.entries(groupedResponses).map(([section, items]) => (
                                                    <div key={section} className="bg-gray-50/50 p-6 rounded-3xl border border-gray-100">
                                                        <h4 className="text-[10px] font-black text-xigo uppercase tracking-[0.2em] mb-4 flex items-center gap-2">
                                                            <span className="w-1.5 h-1.5 bg-xigo rounded-full"></span>
                                                            {section}
                                                        </h4>
                                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                                            {items.map((item, idx) => (
                                                                <div key={idx} className="bg-white p-4 rounded-2xl shadow-sm border border-gray-100/50">
                                                                    <p className="text-[10px] font-bold text-gray-400 mb-1 leading-snug uppercase">{item.q}</p>
                                                                    <p className="text-sm font-black text-gray-700 italic">
                                                                        {Array.isArray(item.val) ? item.val.join(", ") : item.val}
                                                                    </p>
                                                                </div>
                                                            ))}
                                                        </div>
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                    )}
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen flex items-center justify-center p-2 sm:p-4 bg-gray-50 font-sans">
                    <div className="bg-white w-full max-w-lg rounded-[2.5rem] shadow-2xl overflow-hidden flex flex-col h-[750px] sm:h-[800px] border border-gray-100">
                        <div onClick={handleAdminAccess} className="header-bg flex-shrink-0 h-40 sm:h-48 cursor-default">
                            <img src={LOGO_URL} alt="XIGO Header" className="header-img" />
                        </div>

                        <div className="p-6 sm:p-10 flex-grow flex flex-col overflow-hidden">
                            {step === 'survey' && (
                                <div className="fade-in flex flex-col h-full">
                                    <div className="w-full bg-gray-100 h-1.5 rounded-full mb-6 overflow-hidden flex-shrink-0">
                                        <div className="bg-xigo h-full transition-all duration-700" style={{ width: `${((currentIdx + 1) / surveyData.length) * 100}%` }}></div>
                                    </div>
                                    
                                    <div className="flex-grow overflow-y-auto custom-scrollbar pr-2">
                                        <p className="text-xigo font-bold text-[9px] uppercase mb-1 opacity-70 tracking-widest">{surveyData[currentIdx].section}</p>
                                        <h2 className="text-xl font-extrabold text-gray-800 leading-tight mb-6">{surveyData[currentIdx].title}</h2>
                                        
                                        <div className="space-y-2.5">
                                            {surveyData[currentIdx].options.map((opt, i) => (
                                                <button 
                                                    key={i} 
                                                    onClick={() => handleSelect(opt)}
                                                    className={`w-full p-4 rounded-2xl text-left font-bold text-sm transition-all border-2 
                                                        ${selectedInStep.includes(opt) ? 'border-xigo bg-xigo-light text-xigo shadow-sm' : 'border-gray-50 bg-white text-gray-600 hover:border-gray-200'}`}
                                                >
                                                    {opt}
                                                </button>
                                            ))}
                                        </div>
                                    </div>

                                    <div className="mt-4 flex-shrink-0">
                                        {surveyData[currentIdx].type === 'multiple' && selectedInStep.length > 0 && (
                                            <button onClick={nextStep} className="w-full bg-xigo text-white font-black py-4 rounded-2xl shadow-lg uppercase tracking-widest active:scale-95 transition-transform">
                                                Siguiente
                                            </button>
                                        )}
                                        <p className="text-center text-[9px] text-gray-300 mt-4 font-bold uppercase tracking-widest">Pregunta {currentIdx + 1} de {surveyData.length}</p>
                                    </div>
                                </div>
                            )}

                            {step === 'email' && (
                                <div className="fade-in text-center py-6 flex-grow flex flex-col justify-center">
                                    <div className="text-5xl mb-6 animate-bounce">üç∑</div>
                                    <h2 className="text-2xl font-black text-gray-800 mb-4 uppercase italic tracking-tighter">¬°Casi listo!</h2>
                                    <p className="text-gray-500 text-sm mb-8 italic font-medium">Gracias por completar las 23 preguntas. Recibe tu cup√≥n del **15% de descuento** para Vina Mar√≠a (@vinamariaec).</p>
                                    <input type="email" value={email} onChange={(e) => setEmail(e.target.value)} placeholder="tu@email.com" className="w-full p-5 rounded-2xl border-2 border-gray-100 focus:border-xigo outline-none mb-4 text-center font-bold text-gray-700" />
                                    <button onClick={submitEmail} disabled={isLoading} className="w-full bg-xigo text-white font-black py-5 rounded-2xl shadow-xl uppercase tracking-widest disabled:opacity-50">
                                        {isLoading ? "PROCESANDO..." : "Obtener mi Descuento"}
                                    </button>
                                </div>
                            )}

                            {step === 'success' && (
                                <div className="fade-in text-center py-10 flex-grow flex flex-col justify-center">
                                    <div className="w-20 h-20 bg-green-100 text-xigo rounded-full flex items-center justify-center text-4xl mx-auto mb-6">‚úì</div>
                                    <h2 className="text-3xl font-black text-xigo mb-4 uppercase italic">¬°GRACIAS!</h2>
                                    <p className="text-gray-600 mb-8 font-medium italic">Tus respuestas nos ayudar√°n a crear el mejor concepto Grab & Go de Guayaquil.</p>
                                    <button onClick={() => window.location.reload()} className="text-xigo font-black underline uppercase text-[10px] tracking-widest">Nueva encuesta</button>
                                </div>
                            )}

                            {step === 'terminated' && (
                                <div className="fade-in text-center py-10 flex-grow flex flex-col justify-center">
                                    <h2 className="text-xl font-black text-gray-800 mb-4 uppercase">FIN DE LA ENCUESTA</h2>
                                    <p className="text-gray-500 text-sm mb-10 px-6 font-medium italic">Gracias por tu honestidad. XIGO busca perfiles espec√≠ficos que consuman comida fuera de casa frecuentemente.</p>
                                    <button onClick={() => window.location.reload()} className="text-xigo font-bold underline uppercase text-xs">Inicio</button>
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
